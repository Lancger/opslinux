# 一、简介
`
在上一篇《Prometheus+Node_exporter+Grafana+Alertmanager监控部署》里，已经有了promethues的一套监控环境。但是这里有个问题，就是在prometheus.yml里配置需要监听的服务时，是按服务名写死的，如果后面增加了节点或者组件信息，就得手动修改此配置，并重启promethues；那么能否动态的监听微服务呢？Prometheus 提供了多种动态服务发现的功能，这里以consul为例。
`
# 二、引入consul的好处
`
在没有使用consul服务自动发现的时候，我们需要频繁对Prometheus配置文件进行修改，无疑给运维人员带来很大的负担，还有可能直接变成一个“配置小王子”，即使是配置小王子也会存在人为失误的情况。
`

# 三、Prometheus支持的多种服务发现机制
```
#Prometheus数据源的配置主要分为静态配置和动态发现, 常用的为以下几类:
static_configs: 静态服务发现
file_sd_configs: 文件服务发现
dns_sd_configs: DNS 服务发现
kubernetes_sd_configs: Kubernetes 服务发现
consul_sd_configs: Consul 服务发现
...

在监控kubernetes的应用场景中，频繁更新的pod，svc，等等资源配置应该是最能体现Prometheus监控目标自动发现服务的好处
```
